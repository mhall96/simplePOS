{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import auth0 from'auth0-js';import history from'./history';var Auth=function Auth(){var _this=this;_classCallCheck(this,Auth);this.auth0=new auth0.WebAuth({domain:'divyanshu.auth0.com',clientID:'TJyKPI6aRiRwgr6SxlT7ExW10NEHW4Vy',redirectUri:process.env.NODE_ENV==='development'?'http://localhost:3000/callback':'https://appbaseio-apps.github.io/reactivesearch-auth0-example/callback',audience:'https://divyanshu.auth0.com/userinfo',responseType:'token id_token',scope:'openid'});this.login=function(){_this.auth0.authorize();};this.handleAuthentication=function(){_this.auth0.parseHash(function(err,authResult){if(authResult&&authResult.accessToken&&authResult.idToken){_this.setSession(authResult);history.replace('/home');}else if(err){history.replace('/home');console.log(err);}});};this.setSession=function(authResult){// Set the time that the access token will expire at\nvar expiresAt=JSON.stringify(authResult.expiresIn*1000+new Date().getTime());localStorage.setItem('access_token',authResult.accessToken);localStorage.setItem('id_token',authResult.idToken);localStorage.setItem('expires_at',expiresAt);// navigate to the home route\nhistory.replace('/home');};this.logout=function(){// Clear access token and ID token from local storage\nlocalStorage.removeItem('access_token');localStorage.removeItem('id_token');localStorage.removeItem('expires_at');// navigate to the home route\nhistory.replace('/home');};this.isAuthenticated=function(){// Check whether the current time is past the\n// access token's expiry time\nvar expiresAt=JSON.parse(localStorage.getItem('expires_at'));return new Date().getTime()<expiresAt;};};export{Auth as default};","map":{"version":3,"sources":["C:/Users/victoria/Documents/Project/simplePOS/frontend/src/auth.js"],"names":["auth0","history","Auth","WebAuth","domain","clientID","redirectUri","process","env","NODE_ENV","audience","responseType","scope","login","authorize","handleAuthentication","parseHash","err","authResult","accessToken","idToken","setSession","replace","console","log","expiresAt","JSON","stringify","expiresIn","Date","getTime","localStorage","setItem","logout","removeItem","isAuthenticated","parse","getItem"],"mappings":"oJAAA,MAAOA,CAAAA,KAAP,KAAkB,UAAlB,CAEA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,C,GAEqBC,CAAAA,I,gEAEpBF,K,CAAQ,GAAIA,CAAAA,KAAK,CAACG,OAAV,CAAkB,CACzBC,MAAM,CAAE,qBADiB,CAEzBC,QAAQ,CAAE,kCAFe,CAGzBC,WAAW,CAAEC,OAAO,CAACC,GAAR,CAAYC,QAAZ,GAAyB,aAAzB,CAAyC,gCAAzC,CAA4E,wEAHhE,CAIzBC,QAAQ,CAAE,sCAJe,CAKzBC,YAAY,CAAE,gBALW,CAMzBC,KAAK,CAAE,QANkB,CAAlB,C,MASRC,K,CAAQ,UAAM,CACb,KAAI,CAACb,KAAL,CAAWc,SAAX,GACA,C,MAGDC,oB,CAAuB,UAAM,CAC5B,KAAI,CAACf,KAAL,CAAWgB,SAAX,CAAqB,SAACC,GAAD,CAAMC,UAAN,CAAqB,CACzC,GAAIA,UAAU,EAAIA,UAAU,CAACC,WAAzB,EAAwCD,UAAU,CAACE,OAAvD,CAAgE,CAC/D,KAAI,CAACC,UAAL,CAAgBH,UAAhB,EACAjB,OAAO,CAACqB,OAAR,CAAgB,OAAhB,EACA,CAHD,IAGO,IAAIL,GAAJ,CAAS,CACfhB,OAAO,CAACqB,OAAR,CAAgB,OAAhB,EACAC,OAAO,CAACC,GAAR,CAAYP,GAAZ,EACA,CACD,CARD,EASA,C,MAGDI,U,CAAa,SAACH,UAAD,CAAgB,CAC5B;AACA,GAAIO,CAAAA,SAAS,CAAGC,IAAI,CAACC,SAAL,CAAgBT,UAAU,CAACU,SAAX,CAAuB,IAAxB,CAAgC,GAAIC,CAAAA,IAAJ,GAAWC,OAAX,EAA/C,CAAhB,CACAC,YAAY,CAACC,OAAb,CAAqB,cAArB,CAAqCd,UAAU,CAACC,WAAhD,EACAY,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAiCd,UAAU,CAACE,OAA5C,EACAW,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAmCP,SAAnC,EACA;AACAxB,OAAO,CAACqB,OAAR,CAAgB,OAAhB,EACA,C,MAGDW,M,CAAS,UAAM,CACd;AACAF,YAAY,CAACG,UAAb,CAAwB,cAAxB,EACAH,YAAY,CAACG,UAAb,CAAwB,UAAxB,EACAH,YAAY,CAACG,UAAb,CAAwB,YAAxB,EACA;AACAjC,OAAO,CAACqB,OAAR,CAAgB,OAAhB,EACA,C,MAGDa,e,CAAkB,UAAM,CACvB;AACA;AACA,GAAIV,CAAAA,SAAS,CAAGC,IAAI,CAACU,KAAL,CAAWL,YAAY,CAACM,OAAb,CAAqB,YAArB,CAAX,CAAhB,CACA,MAAO,IAAIR,CAAAA,IAAJ,GAAWC,OAAX,GAAuBL,SAA9B,CACA,C,UAvDmBvB,I","sourcesContent":["import auth0 from 'auth0-js';\r\n\r\nimport history from './history';\r\n\r\nexport default class Auth {\r\n\t// Please use your own credentials here\r\n\tauth0 = new auth0.WebAuth({\r\n\t\tdomain: 'divyanshu.auth0.com',\r\n\t\tclientID: 'TJyKPI6aRiRwgr6SxlT7ExW10NEHW4Vy',\r\n\t\tredirectUri: process.env.NODE_ENV === 'development' ? 'http://localhost:3000/callback' : 'https://appbaseio-apps.github.io/reactivesearch-auth0-example/callback',\r\n\t\taudience: 'https://divyanshu.auth0.com/userinfo',\r\n\t\tresponseType: 'token id_token',\r\n\t\tscope: 'openid'\r\n\t});\r\n\r\n\tlogin = () => {\r\n\t\tthis.auth0.authorize();\r\n\t}\r\n\r\n\t// parses the result after authentication from URL hash\r\n\thandleAuthentication = () => {\r\n\t\tthis.auth0.parseHash((err, authResult) => {\r\n\t\t\tif (authResult && authResult.accessToken && authResult.idToken) {\r\n\t\t\t\tthis.setSession(authResult);\r\n\t\t\t\thistory.replace('/home');\r\n\t\t\t} else if (err) {\r\n\t\t\t\thistory.replace('/home');\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// Sets user details in localStorage\r\n\tsetSession = (authResult) => {\r\n\t\t// Set the time that the access token will expire at\r\n\t\tlet expiresAt = JSON.stringify((authResult.expiresIn * 1000) + new Date().getTime());\r\n\t\tlocalStorage.setItem('access_token', authResult.accessToken);\r\n\t\tlocalStorage.setItem('id_token', authResult.idToken);\r\n\t\tlocalStorage.setItem('expires_at', expiresAt);\r\n\t\t// navigate to the home route\r\n\t\thistory.replace('/home');\r\n\t}\r\n\r\n\t// removes user details from localStorage\r\n\tlogout = () => {\r\n\t\t// Clear access token and ID token from local storage\r\n\t\tlocalStorage.removeItem('access_token');\r\n\t\tlocalStorage.removeItem('id_token');\r\n\t\tlocalStorage.removeItem('expires_at');\r\n\t\t// navigate to the home route\r\n\t\thistory.replace('/home');\r\n\t}\r\n\r\n\t// checks if the user is authenticated\r\n\tisAuthenticated = () => {\r\n\t\t// Check whether the current time is past the\r\n\t\t// access token's expiry time\r\n\t\tlet expiresAt = JSON.parse(localStorage.getItem('expires_at'));\r\n\t\treturn new Date().getTime() < expiresAt;\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}