{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\src\\\\Form.js\";\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Input from \"./Input\";\n\nclass Form extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleError = (field, errmsg) => {\n      if (!field) return;\n\n      if (errmsg) {\n        this.setState(prevState => ({\n          failure: '',\n          errcount: prevState.errcount + 1,\n          errmsgs: _objectSpread({}, prevState.errmsgs, {\n            [field]: errmsg\n          })\n        }));\n      } else {\n        this.setState(prevState => ({\n          failure: '',\n          errcount: prevState.errcount === 1 ? 0 : prevState.errcount - 1,\n          errmsgs: _objectSpread({}, prevState.errmsgs, {\n            [field]: ''\n          })\n        }));\n      }\n    };\n\n    this.renderError = () => {\n      if (this.state.errcount || this.state.failure) {\n        const errmsg = this.state.failure || Object.values(this.state.errmsgs).find(v => v);\n        return React.createElement(\"div\", {\n          className: \"error\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 40\n          },\n          __self: this\n        }, errmsg);\n      }\n    };\n\n    this.handleSubmit = event => {\n      event.preventDefault();\n\n      if (!this.state.errcount) {\n        const data = new FormData(this.form);\n        fetch(this.form.action, {\n          method: this.form.method,\n          body: new URLSearchParams(data)\n        }).then(v => {\n          if (v.redirected) window.location = v.url;\n        }).catch(e => console.warn(e));\n      }\n    };\n\n    if (props.error) {\n      this.state = {\n        failure: \"wrong username or password\",\n        errcount: 0\n      };\n    } else {\n      this.state = {\n        errcount: 0\n      };\n    }\n  }\n\n  render() {\n    const inputs = this.props.inputs.map(({\n      name,\n      placeholder,\n      type,\n      value,\n      className\n    }, index) => React.createElement(Input, {\n      key: index,\n      name: name,\n      placeholder: placeholder,\n      type: type,\n      value: value,\n      className: type === \"submit\" ? className : \"\",\n      handleError: this.handleError,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }));\n    const errors = this.renderError();\n    return React.createElement(\"form\", Object.assign({}, this.props, {\n      onSubmit: this.handleSubmit,\n      ref: fm => {\n        this.form = fm;\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }), inputs, errors);\n  }\n\n}\n\nForm.propTypes = {\n  name: PropTypes.string,\n  action: PropTypes.string,\n  method: PropTypes.string,\n  inputs: PropTypes.array,\n  error: PropTypes.string\n};\nexport default Form;","map":{"version":3,"sources":["C:/Users/victoria/Documents/Project/simplePOS/frontend/src/Form.js"],"names":["React","Component","PropTypes","Input","Form","constructor","props","handleError","field","errmsg","setState","prevState","failure","errcount","errmsgs","renderError","state","Object","values","find","v","handleSubmit","event","preventDefault","data","FormData","form","fetch","action","method","body","URLSearchParams","then","redirected","window","location","url","catch","e","console","warn","error","render","inputs","map","name","placeholder","type","value","className","index","errors","fm","propTypes","string","array"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport Input from \"./Input\";\r\n\r\nclass Form extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tif (props.error) {\r\n\t\t\tthis.state = {\r\n\t\t\t\tfailure: \"wrong username or password\",\r\n\t\t\t\terrcount: 0\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.state = { errcount: 0 }\r\n\t\t}\r\n\t}\r\n\r\n\thandleError = (field, errmsg) => {\r\n\t\tif (!field) return\r\n\r\n\t\tif (errmsg) {\r\n\t\t\tthis.setState((prevState) => ({\r\n\t\t\t\tfailure: '',\r\n\t\t\t\terrcount: prevState.errcount + 1,\r\n\t\t\t\terrmsgs: { ...prevState.errmsgs, [field]: errmsg }\r\n\t\t\t}))\r\n\t\t} else {\r\n\t\t\tthis.setState((prevState) => ({\r\n\t\t\t\tfailure: '',\r\n\t\t\t\terrcount: prevState.errcount === 1 ? 0 : prevState.errcount - 1,\r\n\t\t\t\terrmsgs: { ...prevState.errmsgs, [field]: '' }\r\n\t\t\t}))\r\n\t\t}\r\n\t}\r\n\r\n\trenderError = () => {\r\n\t\tif (this.state.errcount || this.state.failure) {\r\n\t\t\tconst errmsg = this.state.failure\r\n\t\t\t\t|| Object.values(this.state.errmsgs).find(v => v)\r\n\t\t\treturn <div className=\"error\">{errmsg}</div>\r\n\t\t}\r\n\t}\r\n\r\n\thandleSubmit = (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tif (!this.state.errcount) {\r\n\t\t\tconst data = new FormData(this.form)\r\n\t\t\tfetch(this.form.action, {\r\n\t\t\t\tmethod: this.form.method,\r\n\t\t\t\tbody: new URLSearchParams(data)\r\n\t\t\t})\r\n\t\t\t\t.then(v => {\r\n\t\t\t\t\tif (v.redirected) window.location = v.url\r\n\t\t\t\t})\r\n\t\t\t\t.catch(e => console.warn(e))\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst inputs = this.props.inputs.map(\r\n\t\t\t({ name, placeholder, type, value, className }, index) => (\r\n\t\t\t\t<Input key={index} name={name} placeholder={placeholder} type={type} value={value}\r\n\t\t\t\t\tclassName={type === \"submit\" ? className : \"\"} handleError={this.handleError} />\r\n\t\t\t)\r\n\t\t)\r\n\t\tconst errors = this.renderError();\r\n\t\treturn (\r\n\t\t\t<form {...this.props} onSubmit={this.handleSubmit} ref={fm => { this.form = fm }}>\r\n\t\t\t\t{inputs}\r\n\t\t\t\t{errors}\r\n\t\t\t</form>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nForm.propTypes = {\r\n\tname: PropTypes.string,\r\n\taction: PropTypes.string,\r\n\tmethod: PropTypes.string,\r\n\tinputs: PropTypes.array,\r\n\terror: PropTypes.string\r\n}\r\n\r\nexport default Form"]},"metadata":{},"sourceType":"module"}