{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _classCallCheck from\"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\victoria\\\\Documents\\\\Project\\\\simplePOS\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from'react';import'./App.css';import AppNavbar from'./AppNavbar';import{Link}from'react-router-dom';import{Button,Container}from'reactstrap';import{withCookies}from'react-cookie';var Home=/*#__PURE__*/function(_Component){_inherits(Home,_Component);function Home(props){var _this;_classCallCheck(this,Home);_this=_possibleConstructorReturn(this,_getPrototypeOf(Home).call(this,props));_this.state={isLoading:true,isAuthenticated:false,user:undefined};var cookies=props.cookies;_this.state.csrfToken=cookies.get('XSRF-TOKEN');_this.login=_this.login.bind(_assertThisInitialized(_this));_this.logout=_this.logout.bind(_assertThisInitialized(_this));return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){var response,body;return _regeneratorRuntime.async(function componentDidMount$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(fetch('/api/user',{credentials:'include'}));case 2:response=_context.sent;_context.next=5;return _regeneratorRuntime.awrap(response.text());case 5:body=_context.sent;if(body===''){this.setState({isAuthenticated:false});}else{this.setState({isAuthenticated:true,user:JSON.parse(body)});}case 7:case\"end\":return _context.stop();}}},null,this);}},{key:\"login\",value:function login(){var port=window.location.port?':'+window.location.port:'';if(port===':3000'){port=':8080';}window.location.href='//'+window.location.hostname+port+'/private';}},{key:\"logout\",value:function logout(){fetch('/api/logout',{method:'POST',credentials:'include',headers:{'X-XSRF-TOKEN':this.state.csrfToken}}).then(function(res){return res.json();}).then(function(response){window.location.href=response.logoutUrl+\"?id_token_hint=\"+response.idToken+\"&post_logout_redirect_uri=\"+window.location.origin;});}},{key:\"render\",value:function render(){var message=this.state.user?React.createElement(\"h2\",null,\"Welcome, \",this.state.user.name,\"!\"):React.createElement(\"p\",null,\"Please log in to manage your JUG Tour.\");var button=this.state.isAuthenticated?React.createElement(\"div\",null,React.createElement(Button,{color:\"link\"},React.createElement(Link,{to:\"/groups\"},\"Manage JUG Tour\")),React.createElement(\"br\",null),React.createElement(Button,{color:\"link\",onClick:this.logout},\"Logout\")):React.createElement(Button,{color:\"primary\",onClick:this.login},\"Login\");return React.createElement(\"div\",null,React.createElement(AppNavbar,null),React.createElement(Container,{fluid:true},message,button));}}]);return Home;}(Component);export default withCookies(Home);","map":{"version":3,"sources":["C:/Users/victoria/Documents/Project/simplePOS/frontend/src/Home.js"],"names":["React","Component","AppNavbar","Link","Button","Container","withCookies","Home","props","state","isLoading","isAuthenticated","user","undefined","cookies","csrfToken","get","login","bind","logout","fetch","credentials","response","text","body","setState","JSON","parse","port","window","location","href","hostname","method","headers","then","res","json","logoutUrl","idToken","origin","message","name","button"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './App.css';\r\nimport AppNavbar from './AppNavbar';\r\nimport { Link } from 'react-router-dom';\r\nimport { Button, Container } from 'reactstrap';\r\nimport { withCookies } from 'react-cookie';\r\n\r\nclass Home extends Component {\r\n\tstate = {\r\n\t\tisLoading: true,\r\n\t\tisAuthenticated: false,\r\n\t\tuser: undefined\r\n\t};\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tconst { cookies } = props;\r\n\t\tthis.state.csrfToken = cookies.get('XSRF-TOKEN');\r\n\t\tthis.login = this.login.bind(this);\r\n\t\tthis.logout = this.logout.bind(this);\r\n\t}\r\n\r\n\tasync componentDidMount() {\r\n\t\tconst response = await fetch('/api/user', { credentials: 'include' });\r\n\t\tconst body = await response.text();\r\n\t\tif (body === '') {\r\n\t\t\tthis.setState(({ isAuthenticated: false }))\r\n\t\t} else {\r\n\t\t\tthis.setState({ isAuthenticated: true, user: JSON.parse(body) })\r\n\t\t}\r\n\t}\r\n\r\n\tlogin() {\r\n\t\tlet port = (window.location.port ? ':' + window.location.port : '');\r\n\t\tif (port === ':3000') {\r\n\t\t\tport = ':8080';\r\n\t\t}\r\n\t\twindow.location.href = '//' + window.location.hostname + port + '/private';\r\n\t}\r\n\r\n\tlogout() {\r\n\t\tfetch('/api/logout', {\r\n\t\t\tmethod: 'POST', credentials: 'include',\r\n\t\t\theaders: { 'X-XSRF-TOKEN': this.state.csrfToken }\r\n\t\t}).then(res => res.json())\r\n\t\t\t.then(response => {\r\n\t\t\t\twindow.location.href = response.logoutUrl + \"?id_token_hint=\" +\r\n\t\t\t\t\tresponse.idToken + \"&post_logout_redirect_uri=\" + window.location.origin;\r\n\t\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst message = this.state.user ?\r\n\t\t\t<h2>Welcome, {this.state.user.name}!</h2> :\r\n\t\t\t<p>Please log in to manage your JUG Tour.</p>;\r\n\r\n\t\tconst button = this.state.isAuthenticated ?\r\n\t\t\t<div>\r\n\t\t\t\t<Button color=\"link\"><Link to=\"/groups\">Manage JUG Tour</Link></Button>\r\n\t\t\t\t<br />\r\n\t\t\t\t<Button color=\"link\" onClick={this.logout}>Logout</Button>\r\n\t\t\t</div> :\r\n\t\t\t<Button color=\"primary\" onClick={this.login}>Login</Button>;\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<AppNavbar />\r\n\t\t\t\t<Container fluid>\r\n\t\t\t\t\t{message}\r\n\t\t\t\t\t{button}\r\n\t\t\t\t</Container>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withCookies(Home);"]},"metadata":{},"sourceType":"module"}